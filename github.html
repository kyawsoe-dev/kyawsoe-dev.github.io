<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Home - Public Repo</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pikaday/1.6.1/css/pikaday.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/github.css">
    <!-- google ads -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1284575678233580"
        crossorigin="anonymous"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TPET8D6TSW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-TPET8D6TSW');
    </script>
</head>

<body>
    <div class="sticky-top">
        <nav class="navbar navbar-expand-md navbar-light bg-white p-2 border-bottom shadow-sm">
            <div class="container-fluid">
                <img src="assets/img/kslogo.png" width="120" height="40" alt="Logo">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item">
                            <a class="nav-link text-dark" href="index.html" style="width: 100px;">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark" href="cv.html" style="width: 150px;">Curriculum Vitae</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark" href="projects.html" style="width: 100px;">Projects</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active text-secondary" href="github.html" style="width: 100px;">Public Repo</a>
                        </li>
                        <li class="nav-item mt-1">
                            <button id="theme-toggle" class="btn btn-sm btn-outline-secondary ml-3">
                                <i class="fas fa-moon"></i>
                            </button>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>

    <main class="page projets-page">
      <section class="portfolio-block" style="padding-top: 20px !important;">
          <div class="container">
            <h2>
              <i class="fab fa-github"></i>
              <a href="https://github.com/kyawsoe-dev" target="_blank" class="text-dark">
                Github.com/kyawsoe-dev
              </a>
            </h2>

            <div class="d-flex justify-content-between align-items-center my-3 flex-wrap">
              <p id="contrib-summary" class="text-muted mb-2 mb-md-0"></p>
              <div class="d-flex align-items-center">
                <label for="year-filter" class="mt-1 mr-1">Select Year: </label>
                <select id="year-filter" class="form-select w-auto d-inline-block"></select>
              </div>
            </div>

            <div id="contrib-graph" class="contrib-graph mb-3"></div>

            <div class="d-flex justify-content-between align-items-center flex-wrap">
              <a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-profile/managing-contribution-graphs-on-your-profile/why-are-my-contributions-not-showing-up-on-my-profile" 
                target="_blank" class="text-muted small">
                Learn how we count contributions
              </a>
              <div class="d-flex align-items-center small">
                <span class="me-2">Less</span>
                <div class="contrib-cell level-0 mx-1"></div>
                <div class="contrib-cell level-1 mx-1"></div>
                <div class="contrib-cell level-2 mx-1"></div>
                <div class="contrib-cell level-3 mx-1"></div>
                <div class="contrib-cell level-4 mx-1"></div>
                <span class="ms-2">More</span>
              </div>
            </div>
          </div>
          
        </section>

        <section>
            <div class="container">
                <div id="repos" class="repo-container"></div>
            </div>
        </section>
    </main>

    <script>
    const toggleBtn = document.getElementById("theme-toggle");
    const body = document.body;

    const savedTheme = localStorage.getItem("theme");
    if (!savedTheme) {
      localStorage.setItem("theme", "dark");
    }
    if (localStorage.getItem("theme") === "dark") {
      body.classList.add("dark-mode");
      toggleBtn.innerHTML = '<i class="fas fa-sun"></i>';
    }
    toggleBtn.addEventListener("click", () => {
      body.classList.toggle("dark-mode");
      if (body.classList.contains("dark-mode")) {
        localStorage.setItem("theme", "dark");
        toggleBtn.innerHTML = '<i class="fas fa-sun"></i>';
      } else {
        localStorage.setItem("theme", "light");
        toggleBtn.innerHTML = '<i class="fas fa-moon"></i>';
      }
    });

    const BASE_URL = "https://api.github.com/search/repositories?q=user:kyawsoe-dev+fork:true&sort=updated&per_page=10&type=All";
    let currentPage = 1;
    let isLoading = false;
    let hasMore = true;

    async function fetchRepositories(page) {
      try {
        const response = await fetch(`${BASE_URL}&page=${page}`);
        const data = await response.json();
        return data.items || [];
      } catch (error) {
        console.error("Error fetching GitHub repos:", error);
        return [];
      }
    }

    async function displayRepos() {
      if (isLoading || !hasMore) return;
      isLoading = true;

      const container = document.getElementById("repos");
      const loading = document.createElement("div");
      loading.id = "loading";
      loading.className = "text-center my-3";
      loading.innerText = "Loading...";
      container.appendChild(loading);

      const repos = await fetchRepositories(currentPage);
      document.getElementById("loading").remove();

      if (repos.length === 0) {
        hasMore = false;
        const endMessage = document.createElement("p");
        endMessage.className = "text-center text-muted my-3";
        endMessage.innerText = "No more repositories";
        container.appendChild(endMessage);
      } else {
        repos.forEach((repo) => {
          const repoCard = document.createElement("div");
          repoCard.className = "repo-card";
          repoCard.innerHTML = `
            <a href="${repo.html_url}" class="share-btn" target="_blank">
                <i class="fas fa-external-link-alt"></i>
            </a>
            <h4><a href="${repo.html_url}" target="_blank">${repo.name}</a></h4>
            <p>${repo.description || "No description"}</p>
            <div class="repo-meta">
              ‚≠ê ${repo.stargazers_count} &nbsp;&nbsp; 
              <i class="fas fa-code-branch"></i> ${repo.forks_count} &nbsp;&nbsp; 
              üïí Updated ${new Date(repo.updated_at).toLocaleDateString()}
            </div>`;
          container.appendChild(repoCard);
        });

        currentPage++;
      }
      isLoading = false;
    }

    window.addEventListener("scroll", () => {
      if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 200) {
        displayRepos();
      }
    });

    async function loadContributions(year = "last") {
      const summary = document.getElementById("contrib-summary");
      const container = document.getElementById("contrib-graph");
      const yearFilter = document.getElementById("year-filter");

      summary.innerText = "Loading contributions...";
      container.innerHTML = "";

      try {
        const resp = await fetch(
          `https://github-contributions-api.jogruber.de/v4/kyawsoe-dev?y=${year}`
        );
        const data = await resp.json();

        if (!data || !Array.isArray(data.contributions)) {
          summary.innerText = "No contributions available";
          return;
        }

        if (!yearFilter.options.length) {
          const lastOpt = document.createElement("option");
          lastOpt.value = "last";
          lastOpt.text = "Last 12 months";
          lastOpt.selected = true;
          yearFilter.appendChild(lastOpt);

          const currentYear = new Date().getFullYear();
          for (let y = currentYear; y >= 2020; y--) {
            const opt = document.createElement("option");
            opt.value = y;
            opt.text = y;
            if (String(y) === String(year)) opt.selected = true;
            yearFilter.appendChild(opt);
          }
        } else {
          yearFilter.value = year;
        }

        container.innerHTML = "";
        let total = 0;

        data.contributions.forEach((c) => {
          total += c.count;
          const cell = document.createElement("div");
          cell.className = `contrib-cell level-${c.level}`;
          cell.title = `${c.count} contributions on ${c.date}`;
          container.appendChild(cell);
        });

        summary.innerText =
          year === "last"
            ? `${total} contributions in the last 12 months`
            : `${total} contributions in ${year}`;
      } catch (err) {
        console.log("Error loading contributions:", err);
        summary.innerText = "Unable to load contributions";
      }
    }

    document.getElementById("year-filter").addEventListener("change", (e) => {
      loadContributions(e.target.value);
    });

    displayRepos();
    loadContributions("last");
    </script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pikaday/1.6.1/pikaday.min.js"></script>
    <script src="assets/js/script.min.js?h=f82c1f62e9f66b57f268c9f78badf050"></script>
</body>
</html>
